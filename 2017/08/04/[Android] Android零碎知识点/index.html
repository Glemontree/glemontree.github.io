<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    

    <title>[Android] Android零碎知识点 | day day up!</title>
    <meta name="author" content="Glemontree">
    
    <meta name="description" content="记录我学习的每一步">
    
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="og:title" content="[Android] Android零碎知识点"/>
    <meta property="og:site_name" content="Glemontree&#39;s blog"/>

    
    <meta property="og:image" content="undefined"/>
    

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="alternate" href="/atom.xml" title="Glemontree&#39;s blog" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/materialize.min.css">
    <link rel="stylesheet" href="/css/lib/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/prettify-tomorrow-night-eighties.css" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>


<body>
    <img src="/weixin_favicon.png" style="position: absolute; left: -9999px; opacity: 0; filter: alpha(opacity=0);">

    <nav class="indigo">
    <div class="nav-wrapper">
        <a href="#" data-activates="main-menu" class="button-collapse">
            <i class="fa fa-navicon"></i>
        </a>
        <div class="">
            <a href="/" class="brand-logo hide-on-med-and-down">Glemontree&#39;s blog</a>
            <ul class="right hide-on-med-and-down">
                
                    <li>
                        <a class="menu-home " href="/" >
                            <i class="fa fa-home "></i>
                            
                            首页
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-archive " href="/archives" >
                            <i class="fa fa-archive "></i>
                            
                            归档
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                            <i class="fa fa-bookmark "></i>
                            
                            分类
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-reading " href="/reading" >
                            <i class="fa fa-book "></i>
                            
                            读书
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-about " href="/about" >
                            <i class="fa fa-user "></i>
                            
                            关于
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-search modal-trigger " href="#search" >
                            <i class="fa fa-search "></i>
                            
                            搜索
                        </a>
                    </li>
                
            </ul>
            <div>
    <ul class="side-nav indigo darken-1" id="main-menu">
        

        
            <li class="no-padding">
                <a class="waves-effect menu-home " href="/" >
                    <i class="fa fa-home "></i>
                    
                    首页
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-archive " href="/archives" >
                    <i class="fa fa-archive "></i>
                    
                    归档
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                    <i class="fa fa-bookmark "></i>
                    
                    分类
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-reading " href="/reading" >
                    <i class="fa fa-book "></i>
                    
                    读书
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-about " href="/about" >
                    <i class="fa fa-user "></i>
                    
                    关于
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-search modal-trigger " href="#search" >
                    <i class="fa fa-search "></i>
                    
                    搜索
                </a>
            </li>
        
    </ul>

    <ul class="side-nav indigo darken-1" id="category-menu">
    

            

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Android/">
                    Android <span class="right">15 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/C/">
                    C <span class="right">24 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Boost/">
                    Boost <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/CMake/">
                    CMake <span class="right">2 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/DB/">
                    DB <span class="right">7 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Effective-Java/">
                    Effective-Java <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/HTTPS/">
                    HTTPS <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Hexo/">
                    Hexo <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/IntelliJ-IDEA/">
                    IntelliJ-IDEA <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/JQuery/">
                    JQuery <span class="right">8 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Java/">
                    Java <span class="right">16 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Linux/">
                    Linux <span class="right">22 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/MyBatis/">
                    MyBatis <span class="right">8 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Qt/">
                    Qt <span class="right">4 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Redis/">
                    Redis <span class="right">3 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Servlet/">
                    Servlet <span class="right">3 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/SpringMVC/">
                    SpringMVC <span class="right">4 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Spring/">
                    Spring <span class="right">5 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Struts2/">
                    Struts2 <span class="right">18 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/TCP-IP/">
                    TCP-IP <span class="right">9 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/TCPIP/">
                    TCPIP <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Windows核心编程/">
                    Windows核心编程 <span class="right">2 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/html/">
                    html <span class="right">7 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/多线程/">
                    多线程 <span class="right">3 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/算法/">
                    算法 <span class="right">3 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/编程规范/">
                    编程规范 <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/网络编程/">
                    网络编程 <span class="right">2 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/设计模式/">
                    设计模式 <span class="right">5 篇</span></a>
                </a>
            </li>

        

    </ul>
</div>

        </div>
    </div>
</nav>

<div id="search" class="modal search-modal">
    <div class="row">
        <div class="input-field col s12">
              <input id="search-input" type="text">
              <label for="search-input">搜索</label>
        </div>

    </div>
    <div id="search-result" class="search-result col s12">

    </div>
</div>


    <main>
        <div class="container main-container">
    <nav class="page-nav hide-on-small-only">
    <div class="nav-wrapper indigo">
        <span class="breadcrumb">当前位置（分类目录）</span>
        
            
    
    
    <a class="breadcrumb" href="/categories/Android/">Android</a>


        

        
    </div>
</nav>

<article>
    <div class="card">
        <div class="card-content">
            

            <div class="article-title">
                
    
        <h1>[Android] Android零碎知识点</h1>
    


            </div>
            <time class="pink-link-context" datetime="2017-08-04T13:56:59.000Z"><a href="/2017/08/04/[Android] Android零碎知识点/">2017-08-04</a></time>

            <span id="busuanzi_container_page_pv" class="read-times-container">
    <i class="fa fa-eye"></i>
    <span id="busuanzi_value_page_pv"></span>
</span>

            
    <div class="tags-row">
        
            <a href="/tags/Android/" class="chip pink lighten-1">Android</a>
        
    </div>


            <div class="toc pink-link-context hide-on-med-and-down">
    
</div>


            <div class="entry pink-link-context">
                <ul>
<li><p><code>?android:selectableItemBackground</code></p>
<p>想要最快速度的给view加上点击效果，试试在xml中加上<code>android:background=&quot;?android:selectableItemBackground&quot;</code>，Android5.0以上是波纹效果，5.0以下是普通的点击效果</p>
</li>
<li><p><code>overridePendingTransition</code></p>
<p> <code>overridePendingTransition</code>这个函数有两个参数，一个参数表示第一个activity进入时的动画，另外一个函数表示第二个activity退出时的动画，需要注意的是此方法需要在startActivity()或者finish()后调用，在切换或者退出时就会调用此动画</p>
</li>
</ul>
<ul>
<li><p>Uri结构</p>
<ul>
<li><p>基本形式：</p>
<p><code>[scheme:]scheme-specific-part[#fragment]</code></p>
<p>这里分为三部分，分别是：scheme、scheme-specific-part、fragment</p>
</li>
<li><p>进一步划分：</p>
<p><code>[scheme:][//authority][path][?query][#fragment]</code></p>
</li>
<li><p>path可以有多个，每个用/连接，比如：<code>scheme:authority/path1/path2/path3?query#fragment</code></p>
</li>
<li><p>query参数可以带有对应的值，也可以不带，如果带对应的值用=表示，如：</p>
<p><code>scheme://authority/path1/path2/path3?id = 1#fragment</code></p>
</li>
<li><p>query参数可以有多个，每个用&amp;连接</p>
<p><code>scheme://authority/path1/path2/path3?id = 1 &amp; name = mingming &amp; old#fragment</code></p>
</li>
<li><p>在android中，除了scheme、authority是必须的，其他的几个path、query、fragment，它们每一个都可以选择要或者不要，但顺序不能变</p>
</li>
<li><p>终极划分</p>
<p>其中authority又可以划分为host:port的形式：</p>
<p><code>[scheme:][//host:port][path][?query][#fragment]</code></p>
</li>
<li><p>本章节参考自文章<a href="http://blog.csdn.net/harvic880925/article/details/44679239" target="_blank" rel="external">Uri详解之——Uri结构与代码提取</a></p>
</li>
</ul>
</li>
<li><p>选择图片、拍照以及图片裁剪</p>
</li>
<li><p>拍照</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">takePhoto</span><span class="params">()</span> </span>&#123;</div><div class="line">  File outputImage = <span class="keyword">new</span> File(Environment.getExternalStorageDirectory(), <span class="string">"tmp.jpg"</span>);</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">if</span> (outputImage.exists()) &#123;</div><div class="line">      outputImage.delete();</div><div class="line">    &#125;</div><div class="line">    outputImage.createNewFile();</div><div class="line">  &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">    e.printStackTrace();</div><div class="line">  &#125;</div><div class="line">  imageUri = Uri.fromFile(outputImage);</div><div class="line">  Intent intent = <span class="keyword">new</span> Intent(<span class="string">"android.media.action.IMAGE_CAPTURE"</span>);</div><div class="line">  intent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri);</div><div class="line">  startActivityForResult(intent, TAKE_PHOTO);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>从相册选择照片</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gotoPickImage</span><span class="params">()</span> </span>&#123;</div><div class="line">  Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI);</div><div class="line">  startActivityForResult(intent, REQUEST_PICK_IMAGE);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>选择一张图片并裁剪获得一个小图</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gotoPickAndCropSmallBitmap</span><span class="params">()</span> </span>&#123;</div><div class="line">  Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_GET_CONTENT);</div><div class="line">  intent.setType(<span class="string">"image/*"</span>);</div><div class="line">  intent.putExtra(<span class="string">"crop"</span>, <span class="string">"true"</span>);</div><div class="line">  intent.putExtra(<span class="string">"aspectX"</span>, <span class="number">1</span>);</div><div class="line">  intent.putExtra(<span class="string">"aspectY"</span>, <span class="number">1</span>);</div><div class="line">  intent.putExtra(<span class="string">"outputX"</span>, <span class="number">300</span>);</div><div class="line">  intent.putExtra(<span class="string">"outputY"</span>, <span class="number">300</span>);</div><div class="line">  intent.putExtra(<span class="string">"scale"</span>, <span class="keyword">true</span>);</div><div class="line">  intent.putExtra(<span class="string">"return-data"</span>, <span class="keyword">true</span>);</div><div class="line">  intent.putExtra(<span class="string">"outputFormat"</span>, Bitmap.CompressFormat.JPEG.toString());</div><div class="line">  intent.putExtra(<span class="string">"noFaceDetection"</span>, <span class="keyword">true</span>); <span class="comment">// no face detection</span></div><div class="line">  startActivityForResult(intent, REQUEST_CROP_IMAGE_SMALL);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  在将<code>return-data</code>设为<code>true</code>的时候，在<code>onActivityForResult()</code>中可以直接通过<code>data.getParcelableExtra(&quot;data&quot;)</code>得到裁剪后的Bitmap对象，但是当Bitmap过大时，就不能使用这种方式了，得使用下面这种方式。</p>
<p>  <code>MediaStore.EXTRA_OUTPUT</code>设置裁剪图片的输入Uri，可以通过<code>Uri.formFile(tmpFile)</code>获得。</p>
<ul>
<li><p>选择一张图片并裁剪获得一个大图</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gotoPickAndCropBigBitmap</span><span class="params">()</span> </span>&#123;</div><div class="line">  imageUri = getTmpUri();</div><div class="line">  Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_GET_CONTENT, <span class="keyword">null</span>);</div><div class="line">  intent.setType(<span class="string">"image/*"</span>);</div><div class="line">  intent.putExtra(<span class="string">"crop"</span>, <span class="string">"true"</span>);</div><div class="line">  intent.putExtra(<span class="string">"aspectX"</span>, <span class="number">1</span>);</div><div class="line">  intent.putExtra(<span class="string">"aspectY"</span>, <span class="number">1</span>);</div><div class="line">  intent.putExtra(<span class="string">"outputX"</span>, <span class="number">2000</span>);</div><div class="line">  intent.putExtra(<span class="string">"outputY"</span>, <span class="number">2000</span>);</div><div class="line">  intent.putExtra(<span class="string">"scale"</span>, <span class="keyword">true</span>);</div><div class="line">  intent.putExtra(<span class="string">"return-data"</span>, <span class="keyword">false</span>);</div><div class="line">  intent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri);</div><div class="line">  intent.putExtra(<span class="string">"outputFormat"</span>, Bitmap.CompressFormat.JPEG.toString());</div><div class="line">  intent.putExtra(<span class="string">"noFaceDetection"</span>, <span class="keyword">true</span>); <span class="comment">// no face detection</span></div><div class="line">  startActivityForResult(intent, REQUEST_CROP_IMAGE_BIG);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里把<code>return-data</code>设为<code>false</code>，同时向<code>MediaStore.EXTRA_OUTPUT</code>设置一个临时构造的<code>Uri</code>，这个<code>Uri</code>用来保存裁剪后的大图，裁剪之后，在<code>onActivityForResult()</code>中就可以通过<code>MediaStore.Images.Media.getBitmap(getContentResolver(), imageUri)</code>得到裁剪后的Bitmap大图。</p>
</li>
<li><p>拍照并裁剪</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startImageCapture</span><span class="params">()</span> </span>&#123;</div><div class="line">  String IMAGE_FILE_LOCATION = Environment.getExternalStorageDirectory() + <span class="string">"/"</span> + <span class="string">"posprint"</span> + <span class="string">"/tmp.jpg"</span>;<span class="comment">//temp file</span></div><div class="line"></div><div class="line">  imageUri = Uri.fromFile(<span class="keyword">new</span> File(IMAGE_FILE_LOCATION));<span class="comment">//The Uri to store the big bitmap</span></div><div class="line">  Intent intent = <span class="keyword">new</span> Intent(MediaStore.ACTION_IMAGE_CAPTURE);</div><div class="line">  intent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri);</div><div class="line">  startActivityForResult(intent, REQUEST_CAPTURE_AND_CROP);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//获得临时保存图片的Uri，用当前的毫秒值作为文件名</span></div><div class="line"><span class="function"><span class="keyword">private</span> Uri <span class="title">getTmpUri</span><span class="params">()</span> </span>&#123;</div><div class="line">  String IMAGE_FILE_DIR = Environment.getExternalStorageDirectory() + <span class="string">"/"</span> + <span class="string">"app_name"</span>;</div><div class="line">  File dir = <span class="keyword">new</span> File(IMAGE_FILE_DIR);</div><div class="line">  File file = <span class="keyword">new</span> File(IMAGE_FILE_DIR, Long.toString(System.currentTimeMillis()));</div><div class="line">  <span class="comment">//非常重要！！！如果文件夹不存在必须先手动创建</span></div><div class="line">  <span class="keyword">if</span> (!dir.exists()) &#123;</div><div class="line">    dir.mkdirs();</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> Uri.fromFile(file);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, Intent data)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (resultCode == Activity.RESULT_OK) &#123;</div><div class="line">    Bitmap bitmap = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      <span class="keyword">switch</span> (requestCode) &#123;</div><div class="line">        <span class="keyword">case</span> REQUEST_PICK_IMAGE:</div><div class="line">          <span class="comment">//选择的图片的Uri</span></div><div class="line">          imageUri = data.getData(); </div><div class="line">          bitmap = MediaStore.Images.Media.getBitmap(</div><div class="line">            getContentResolver(), imageUri);</div><div class="line">        <span class="keyword">case</span> REQUEST_CROP_IMAGE_SMALL:</div><div class="line">          <span class="comment">//裁剪后的小图</span></div><div class="line">          bitmap = data.getParcelableExtra(<span class="string">"data"</span>);  </div><div class="line">          <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> REQUEST_CROP_IMAGE_BIG:</div><div class="line">          <span class="comment">//裁剪后的大图</span></div><div class="line">          bitmap = MediaStore.Images.Media.getBitmap(getContentResolver(), imageUri);</div><div class="line">          <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> REQUEST_CAPTURE_AND_CROP:</div><div class="line">          <span class="comment">//得到拍照后的图片并裁剪</span></div><div class="line">          cropImageUri(imageUri, REQUEST_CROP_IMAGE_BIG);</div><div class="line">          <span class="keyword">break</span>;</div><div class="line">      &#125;</div><div class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">      e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  doSomething(bitmap);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//裁剪拍照后得到的图片</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">cropImageUri</span><span class="params">(Uri uri, <span class="keyword">int</span> requestCode)</span> </span>&#123;</div><div class="line">  Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.android.camera.action.CROP"</span>);</div><div class="line">  intent.setDataAndType(uri, <span class="string">"image/*"</span>);</div><div class="line">  <span class="comment">//intent.putExtra("crop", "true");</span></div><div class="line">  intent.putExtra(<span class="string">"aspectX"</span>, <span class="number">1</span>);</div><div class="line">  intent.putExtra(<span class="string">"aspectY"</span>, <span class="number">1</span>);</div><div class="line">  intent.putExtra(<span class="string">"outputX"</span>, <span class="number">500</span>);</div><div class="line">  intent.putExtra(<span class="string">"outputY"</span>, <span class="number">500</span>);</div><div class="line">  intent.putExtra(<span class="string">"scale"</span>, <span class="keyword">true</span>);</div><div class="line">  intent.putExtra(MediaStore.EXTRA_OUTPUT, uri);</div><div class="line">  intent.putExtra(<span class="string">"return-data"</span>, <span class="keyword">false</span>);</div><div class="line">  intent.putExtra(<span class="string">"outputFormat"</span>, Bitmap.CompressFormat.JPEG.toString());</div><div class="line">  intent.putExtra(<span class="string">"noFaceDetection"</span>, <span class="keyword">true</span>); <span class="comment">// no face detection</span></div><div class="line">  intent = Intent.createChooser(intent, <span class="string">"裁剪图片"</span>);</div><div class="line">  startActivityForResult(intent, requestCode);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  这一部分其实分为了两步，第一步拍照得到图片的Uri，第二步把该图片的Uri传给裁剪图片的程序处理：</p>
<ul>
<li>这里的action变成了<code>com.android.camera.action.CROP</code>，并且不需要设置<code>extra</code>字段`crop``</li>
<li><p><code>`intent.setDataAndType(uri, &quot;image/*&quot;)</code>，这里的uri指向拍照后得到的原图，<code>intent.putExtra(MediaStore.EXTRA_OUTPUT, uri)</code>将裁剪后的图片也保存在这个uri，所以原图就被覆盖了</p>
</li>
<li><p>本章节转载自<a href="http://www.jianshu.com/p/b1fd66721b48" target="_blank" rel="external">文章</a>。</p>
</li>
<li><p><code>getCahceDir()</code>、<code>getFilesDir()</code>、<code>getExternalFilesDir()</code>和<code>getExternalCacheDir()</code></p>
</li>
<li><p><code>getCacheDir()</code>方法获取<code>/data/data//cache目录</code></p>
</li>
<li><p><code>getFilesDir()</code>方法获取<code>/data/data//files</code>目录</p>
</li>
<li><p>通过<code>Context.getExternalFilesDir()</code>方法获取到<code>SDCard/Android/data/你的应用的包名/files/</code>目录</p>
<p>，一般放一些长时间保存的数据</p>
</li>
<li><p>通过<code>Context.getExternalCacheDir()</code>方法获取到<code>SDCard/Android/data/你的应用的包名/cache/</code>目录，一般存放临时缓存数据</p>
<p>当使用<code>Context.getExternalFilesDir()</code>和<code>Context.getExternalCacheDir()</code>方法时，当你的应用被卸载后，<code>SDCard/Android/data/你的应用的包名/</code>这个目录下的所有文件都会被删除，不会留下垃圾信息。</p>
<p>较优秀的程序都会专门写一个方法来获取缓存地址：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getDiskCacheDir</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">  String cachePath = <span class="keyword">null</span>;</div><div class="line">  <span class="keyword">if</span> (Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState</div><div class="line">     || !Environment.isExternalStorageRemovable()) &#123;</div><div class="line">    cachePath = context.getExternalCacheDir().getPath();</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    cachePath = context.getCacheDir().getPath();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  可以看到，当SD卡存在或者SD卡不可被移除的时候，就调用<code>getExternalCacheDir()</code>方法来获取缓存路径，否则就调用getCacheDir()方法来获取缓存路径。前者获取到的就是<code>/sdcard/Android/data//cache</code>这个路径，而后者获取到的是<code>/data/data//cache</code> 这个路径。 </p>
<p>  注意：这两种方式的缓存都会在卸载app的时候被系统清理到，而开发者自己在sd卡上建立的缓存文件夹，是不会跟随着app的卸载而被清除掉的。</p>
<ul>
<li><p>Glide的<code>crossFade()</code>方法</p>
<p>无论你是在加载图片之前是否显示一个占位符，改变 ImageView 的图片在你的 UI 中有非常显著的变化。一个简单的选项是让它改变是更加平滑和养眼的，就是使用一个淡入淡出动画。Glide 使用标准的淡入淡出动画，这是(对于当前版本3.6.1)默认激活的。如果你想要如强制 Glide 显示一个淡入淡出动画，你必须调用另外一个建造者：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Glide.with(context)</div><div class="line">  .load(UsageExampleListViewAdapter.eatFoodyImages[<span class="number">0</span>])</div><div class="line">  .placeholder(R.mipmap.ic_launcher) <span class="comment">// can also be a drawable</span></div><div class="line">  .error(R.mipmap.future_studio_launcher) <span class="comment">// will be displayed if the image cannot be loaded</span></div><div class="line">  .crossFade()</div><div class="line">  .into(imageViewFade);</div></pre></td></tr></table></figure>
<p><code>crossFade()</code> 方法还有另外重载方法 <code>crossFade(int duration)</code>。如果你想要去减慢（或加快）动画，随时可以传一个毫秒的时间给这个方法。动画默认的持续时间是 300毫秒。</p>
<p>本章节转载自文章<a href="http://blog.csdn.net/hshshshshs1/article/details/50786203" target="_blank" rel="external">glide的基本使用以及原理</a></p>
</li>
<li><p>FragmentPagerAdapter和FragmentPagerStateAdapter</p>
</li>
<li><p>FragmentPagerAdapter</p>
<p>FragmentPagerAdapter继承自PagerAdapter，是专门给ViewPager进行数据适配的，FragmentPagerAdapter这个适配器是用来实现Fragment在ViewPager里面进行滑动切换的，FragmentPagerAdapter拥有自己的缓存策略，当和ViewPager配合使用的时候，会缓存当前Fragment以及左边一个、右边一个一共三个Fragment对象。</p>
<p>假如有三个Fragment，那么在ViewPager初始化之后，三个fragment都会加载完成，中间的Fragment在整个生命周期里只会加载一次，当最左边的Fragment处于显示状态，最右边的Fragment由于超出缓存范围，会被销毁，当再次滑到中间的Fragment时，最右边的Fragment会被再次初始化。</p>
<p>因此，FragmentPagerAdapter最适合来做固定的较少数量的场合，比如说一个有3个tab标签的fragment滑动界面，FragmentPagerAdapter会对我们浏览过的Fragment进行缓存，保存这些界面的临时状态，这样当我们左右滑动的时候，界面切换会更加的流畅，但是这样也会增加程序占用的内存，如果应用场景是更多的Fragment，请使用FragmentStatePagerAdapter。</p>
</li>
<li><p>FragmentPagerStateAdapter</p>
<p>FragmentPagerStateAdapter也是PagerAdapter的子类，它的工作方式和ListView相似，当Fragment对用户不可见的时候，整个Fragment会被销毁，只会保存Fragment的保存状态，基于这样的特性，FragmentPagerStateAdapter比FragmentPagerAdapter更适合于用于很多界面之间的切换，而且消耗更少的内存资源</p>
</li>
<li><p>本章节转载自文章<a href="http://blog.csdn.net/hknock/article/details/46741573" target="_blank" rel="external">FragmentPagerAdapter与FragmentStatePagerAdapter使用详解与区别</a></p>
</li>
<li><p>CoordinatorLayout与滚动的处理</p>
</li>
<li><p>浮动操作按钮</p>
<p>CoordinatorLayout可以用来配合浮动操作按钮的<code>layout_anchor</code>和<code>layout_gravity</code>属性制造出浮动效果，<code>layout_anchor</code>指定参照物，<code>anchorGravity</code>指定相对于参照物的位置，设置为bottom | right则表示将FloatingActionButton放置于参照物的右下角：</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.design.widget.CoordinatorLayout</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/main_content"</span></div><div class="line">        <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line">        <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</div><div class="line"> </div><div class="line">   <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></div><div class="line">         <span class="attr">android:id</span>=<span class="string">"@+id/rvToDoList"</span></div><div class="line">         <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">         <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</div><div class="line">   <span class="tag">&lt;/<span class="name">android.support.v7.widget.RecyclerView</span>&gt;</span></div><div class="line"> </div><div class="line">   <span class="tag">&lt;<span class="name">android.support.design.widget.FloatingActionButton</span></span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_gravity</span>=<span class="string">"bottom|right"</span></div><div class="line">        <span class="attr">android:layout_margin</span>=<span class="string">"16dp"</span></div><div class="line">        <span class="attr">android:src</span>=<span class="string">"@mipmap/ic_launcher"</span></div><div class="line">        <span class="attr">app:layout_anchor</span>=<span class="string">"@id/rvToDoList"</span></div><div class="line">        <span class="attr">app:layout_anchorGravity</span>=<span class="string">"bottom|right|end"</span>/&gt;</div><div class="line"> <span class="tag">&lt;/<span class="name">android.support.design.widget.CoordinatorLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li><p>Toolbar的扩展和收缩</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.design.widget.CoordinatorLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"> <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/main_content"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span>&gt;</div><div class="line">  </div><div class="line">  	  <span class="tag">&lt;<span class="name">android.support.design.widget.AppBarLayout</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/appbar"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"@dimen/detail_backdrop_height"</span></div><div class="line">        <span class="attr">android:theme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Dark.ActionBar"</span></div><div class="line">        <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span>&gt;</div><div class="line"> </div><div class="line">        <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></div><div class="line">                  <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></div><div class="line">                  <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">                  <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></div><div class="line">                  <span class="attr">app:popupTheme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Light"</span> /&gt;</div><div class="line">      <span class="tag">&lt;/<span class="name">android.support.design.widget.AppBarLayout</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;/<span class="name">android.support.design.widget.CoordinatorLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>需要注意的是AppBarLayout目前必须是第一个嵌套在CoordinatorLayout里面的子View。</p>
<p>然后我们需要定义AppBarLayout与滚动视图之间的联系，在RecyclerView或者任意支持嵌套滚动的View比如NestedScrollView上添加<code>app:layout_behavior</code>，support library包含了一个特殊的字符串资源<code>@string/appbar_scrolling_view_behavior</code>，它的值为<code>android.support.design.widget.AppBarLayout$ScrollingViewBehavior</code>，指向<a href="https://developer.android.com/reference/android/support/design/widget/AppBarLayout.ScrollingViewBehavior.html" target="_blank" rel="external">AppBarLayout.ScrollingViewBehavior</a>，用来通知AppBarLayout这个特殊的view何时发生了滚动事件，这个behavior需要设置在触发滚动事件的view之上。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/rvToDoList"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">app:layout_behavior</span>=<span class="string">"@string/appbar_scrolling_view_behavior"</span>&gt;</div></pre></td></tr></table></figure>
<p>当CoordinatorLayout发现RecyclerView中设置了这个属性，它会搜索自己所包含的其他view，看看是否有view与这个behavior相关联，AppBarLayout.ScrollingViewBehavior描述了RecyclerView与AppBarLayout之间的依赖关系，RecyclerView的任意滚动事件都将触发AppBarLayout或者AppBarLayout里面view的改变。</p>
<p>AppBarLayout里面定义的view只要设置了<code>app:layout_scrollFlags</code>属性，就可以在RecyclerView滚动事件发生时被触发：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.design.widget.AppBarLayout</span></span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:theme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Dark.ActionBar"</span>&gt;</div><div class="line"> </div><div class="line">            <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></div><div class="line">                <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></div><div class="line">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">                <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></div><div class="line">                <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|enterAlways"</span>/&gt;</div><div class="line"> </div><div class="line"> <span class="tag">&lt;/<span class="name">android.support.design.widget.AppBarLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p><code>app:layout_scrollFlags</code>这个属性必须至少启动scroll这个flag，这样这个view才会滚出屏幕，否则它将一直固定在顶部，可以使用的其他flag有：</p>
<ul>
<li>enterAlways: 一旦向上滚动这个view就可见</li>
<li>enterAlwaysCollapsed: 这个flag定义的是何时进入（已经消失之后何时再次显示），假设你定义了一个最小高度（minHeight），同时enterAlways也定义了，那么view将在到达这个最小高度的时候开始显示，并且从这个时候开始慢慢展开，当滚动到顶部的时候展开完</li>
<li>exitUntilCollapsed: 这个flag定义何时退出，当你定义了一个minHeight，这个view将在滚动到这个最小高度的时候消失</li>
</ul>
</li>
<li><p>制造折叠效果</p>
<p>如果想制造Toolbar的折叠效果，必须把ToolBar放在CollapsingToolbarLayout中：</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.design.widget.CollapsingToolbarLayout</span></span></div><div class="line">   <span class="attr">android:id</span>=<span class="string">"@+id/collapsing_toolbar"</span></div><div class="line">   <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">   <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">   <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span></div><div class="line">   <span class="attr">app:contentScrim</span>=<span class="string">"?attr/colorPrimary"</span></div><div class="line">   <span class="attr">app:expandedTitleMarginEnd</span>=<span class="string">"64dp"</span></div><div class="line">   <span class="attr">app:expandedTitleMarginStart</span>=<span class="string">"48dp"</span></div><div class="line">   <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|exitUntilCollapsed"</span>&gt;       </div><div class="line">   <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></div><div class="line">      <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></div><div class="line">      <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">      <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></div><div class="line">      <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|enterAlways"</span>/&gt;<span class="tag">&lt;/<span class="name">android.support.design.widget.CollapsingToolbarLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>  需要注意的是通常我们都是设置ToolBar的Title，而现在，需要将title设置在CollapsingToolbarLayout上，而不是ToolBar：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">CollapsingToolbarLayout collapsingToolbar =</div><div class="line">  (CollapsingToolbarLayout) findViewById(R.id.collapsing_toolbar);</div><div class="line">collapsingToolbar.setTitle(<span class="string">"Title"</span>);</div></pre></td></tr></table></figure>
<ul>
<li><p>制造视觉效果</p>
<p>CollapsingToolbarLayout还能让我们做出更高级的动画，比如在里面放一个ImageView，然后在它折叠的时候渐渐淡出。同时在用户滚动的时候title的高度也会随着改变。</p>
<p>为了制造出这种效果，我们添加一个定义了app:layout_collapseMode=”parallax” 属性的ImageView。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.design.widget.CollapsingToolbarLayout</span></span></div><div class="line">   <span class="attr">android:id</span>=<span class="string">"@+id/collapsing_toolbar"</span></div><div class="line">   <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">   <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">   <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span></div><div class="line">   <span class="attr">app:contentScrim</span>=<span class="string">"?attr/colorPrimary"</span></div><div class="line">   <span class="attr">app:expandedTitleMarginEnd</span>=<span class="string">"64dp"</span></div><div class="line">   <span class="attr">app:expandedTitleMarginStart</span>=<span class="string">"48dp"</span></div><div class="line">   <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|exitUntilCollapsed"</span>&gt;</div><div class="line">   <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></div><div class="line">      <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></div><div class="line">      <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">      <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></div><div class="line">      <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|enterAlways"</span>&gt;</div><div class="line">   <span class="tag">&lt;/<span class="name">android.support.v7.widget.Toolbar</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">ImageView</span></span></div><div class="line">      <span class="attr">android:src</span>=<span class="string">"@drawable/cheese_1"</span></div><div class="line">      <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|enterAlways|enterAlwaysCollapsed"</span></div><div class="line">      <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">      <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">      <span class="attr">android:scaleType</span>=<span class="string">"centerCrop"</span></div><div class="line">      <span class="attr">app:layout_collapseMode</span>=<span class="string">"parallax"</span></div><div class="line">      <span class="attr">android:minHeight</span>=<span class="string">"100dp"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">android.support.design.widget.CollapsingToolbarLayout</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>本章节转载自文章[CoordinatorLayout与滚动的处理(<a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2015/0717/3196.html" target="_blank" rel="external">http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2015/0717/3196.html</a>)</p>
</li>
<li><p>定义数组</p>
<p>Android中可以在res-&gt;values-&gt;array.xml文件中声明数组，例如：</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">string-array</span> <span class="attr">name</span>=<span class="string">"news_type_cn"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>头条<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>社会<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>国内<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>国际<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>娱乐<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>体育<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>军事<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>科技<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>财经<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span>时尚<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">string-array</span>&gt;</span></div></pre></td></tr></table></figure>
<p>  然后在代码中就可以通过如下方式获取数组：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">types = getResources().getStringArray(R.array.news_type_en);</div></pre></td></tr></table></figure>
<ul>
<li><p>ButterKnife的简单实用</p>
<p>要在代码中使用ButterKnife，首先需要在gradle中进行配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">compile &apos;com.jakewharton:butterknife:8.5.1&apos;</div><div class="line">annotationProcessor &apos;com.jakewharton:butterknife-compiler:8.5.1&apos;</div></pre></td></tr></table></figure>
<p>需要注意的是加在<code>Module:app</code>的gradle文件中，加入之后直接同步一下即可，就可在External Libraries文件夹下看到ButterKnife</p>
<p>为了在代码中使用ButterKnife，需要在代码中对ButterKnife服务进行注册：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ButterKnife.bind(this); // 在Activity中使用</div><div class="line">ButterKnife.bind(this, view); // 在非Activity中使用</div></pre></td></tr></table></figure>
<ul>
<li><p>绑定View控件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@BindView</span>(R.id.btn_login)</div><div class="line">Button mBtn; <span class="comment">// 单个View控件的绑定</span></div><div class="line"><span class="meta">@BindViews</span>(&#123;R.id.first_name, R.id.middle_name, R.id.last_name&#125;)</div><div class="line">List&lt;EditText&gt; nameViews; <span class="comment">// 多个控件的绑定可以写在List或者Array中</span></div></pre></td></tr></table></figure>
</li>
<li><p>资源绑定</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@BindString</span>(R.string.title)</div><div class="line">String title;</div><div class="line"><span class="meta">@BindDrawable</span>(R.drawable.graphic)</div><div class="line">Drawabel graphic;</div><div class="line"><span class="meta">@BindColor</span>(R.color.red)</div><div class="line"><span class="keyword">int</span> red;</div><div class="line"><span class="meta">@BindDimen</span>(R.dimen.spacer)</div><div class="line">Float spacer;</div></pre></td></tr></table></figure>
<ul>
<li><p>监听器绑定</p>
<p>监听器可以直接注解到方法上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@OnClick</span>(R.id.submit)</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">submit</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>多个控件可以绑定到同一个监听器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@OnClick</span>(&#123;R.id.submit, R.id.login&#125;)</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHi</span><span class="params">(Button button)</span> </span>&#123;</div><div class="line">  button.setText(<span class="string">"Hello"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>当ButterKnife在Fragment的onCreateView()方法中进行绑定时，需要在onDestroyView()中进行解绑，ButterKnife.bind()方法提供了一个Unbinder返回值，在onDestroyView()中调用相关的unbind()方法即可：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FancyFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</div><div class="line"><span class="meta">@BindView</span>(R.id.button1) Button button1; </div><div class="line"><span class="meta">@BindView</span>(R.id.button2) Button button2;</div><div class="line"><span class="keyword">private</span> Unbinder unbinder; </div><div class="line"><span class="meta">@Override</span> </div><div class="line"><span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span> </span>&#123; </div><div class="line">    View view = inflater.inflate(R.layout.fancy_fragment, container,<span class="keyword">false</span>); </div><div class="line">    unbinder = ButterKnife.bind(<span class="keyword">this</span>, view); </div><div class="line">    <span class="comment">// TODO Use fields... </span></div><div class="line">    <span class="keyword">return</span> view; </div><div class="line">&#125; </div><div class="line"><span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroyView</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">super</span>.onDestroyView(); </div><div class="line">    unbinder.unbind(); </div><div class="line">&#125;&#125;</div></pre></td></tr></table></figure>
<ul>
<li>本章节转载自文章<a href="http://www.jianshu.com/p/9c37856ddf09" target="_blank" rel="external">Butterknife 使用指南</a></li>
</ul>
</li>
<li><p>ActionBar</p>
</li>
<li><p><code>setHomeButtonEnabled</code>这个在小于4.0版本的默认值是true，但是在4.0及其以上是false，该方法的作用是决定左上角的图标是否可以点击，没有向左的小图标，true图标可以点击，false图标不可点击</p>
</li>
<li><p><code>setDisplayHomeAsUpEnabled(true)</code>：给左上角图标的左边加上一个返回的图标，对应<code>ActionBar.DISPLAY_HOME_AS_UP</code></p>
</li>
<li><p><code>setDisplayShowHomeEnabled(true)</code>：使左上角图标是否显示，如果设为false，则没有程序图标，仅仅就是个标题，否则，显示应用程序图标，对应id为<code>Android.R.id.home</code>，对应<code>ActionBar.DISPLAY_SHOW_HOME</code></p>
</li>
<li><p><code>setDispalyShowTitleEnabled(true)</code>：对应<code>ActionBar.DISPLAY_SHOW_TITLE</code></p>
</li>
<li><p><code>setHomeButtonEnabled</code>和<code>setDisplayShowHomeEnabled(true)</code>共同起作用，如果<code>setHomeButtonEnabled</code>设为false，即使<code>setDisplayShowHomeEnabled(true)</code>设为true，图标也不能点击</p>
</li>
<li><p>如果希望点击图标左侧箭头返回上一页，需要加载选项菜单后，对于菜单项的点击事项调用如下方法：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (item.getItemId() == android.R.id.home) &#123;</div><div class="line">    finish();</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>本章节转载自文章 <a href="http://blog.csdn.net/andygo_520/article/details/51439688" target="_blank" rel="external">关于ActionBar中setDisplayHomeAsUpEnabled(true)等方法的问题</a></p>
</li>
<li><p>在实际项目开发过程中，通常为所有的<code>Activity</code>定义一个<code>BaseActivity</code>，可以在<code>BaseActivity</code>中定义：<code>private Activity mActivity;</code>，这样在<code>onCreate()</code>方法中定义<code>mActivity= this</code>，那么子类在继承BaseActivity时在<code>onCreate()</code>方法中通过<code>super.onCreate()</code>方法可以执行BaseActivity的<code>onCreate()</code>方法中的代码，即执行了<code>mActivity = this</code>，那么此时的<code>mActivity</code>也就代表了当前的<code>Activity</code>。</p>
</li>
<li><p>如果想在项目中使用<code>CardView</code>，需要在<code>build.gradle</code>文件中添加下面的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//卡片式布局</div><div class="line">compile &apos;com.android.support:cardview-v7:24.1.1&apos;</div></pre></td></tr></table></figure>
</li>
<li><p>如果想在项目中使用<code>Glide</code>，需要在<code>build.gradle</code>文件中添加下面的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//图片加载框架 Glide</div><div class="line">compile &apos;com.github.bumptech.glide:glide:3.7.0&apos;</div></pre></td></tr></table></figure>
</li>
<li><p>Android ListView与适配器模式</p>
<p>电源适配器相信大家都知道，其作用就是将插座的220V电源转换为电脑所需要的5V电源，在软件开发中，我们称之为接口不兼容，此时就需要适配器来进行接口转换。</p>
<p>因此，适配器模式就是把一个类的接口变成客户端所期待的另外一种接口，从而使原本因接口不匹配而无法一起工作的两个类能够在一起工作。</p>
<p>适配器模式通常涉及到Target、Adapter和Adaptee三部分，Target就是客户端所期望的接口，Adaptee就是需要适配的接口，而Adapter就用来将Adaptee接口转换成Target接口。</p>
<p>适配器模式可以分为类适配器模式和对象适配器模式。</p>
</li>
<li><p>类适配器模式</p>
<p>此时Adapter类需要继承Adaptee并且实现Target接口，在Adapter类中实现的Target接口方法中调用Adaptee中的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Target</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Target</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">target</span><span class="params">()</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Adaptee</span></div><div class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Adaptee</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">adaptee</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"adaptee..."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Adapter</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Adapter</span> <span class="keyword">extends</span> <span class="title">Adaptee</span> <span class="keyword">implements</span> <span class="title">Target</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">target</span><span class="params">()</span> </span>&#123;</div><div class="line">    convertFromAdapteeToTarget();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">convertFromAdapteeToTarget</span><span class="params">()</span> </span>&#123;</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>对象适配器模式</p>
<p>与类的适配器模式不同的是，对象的适配器模式不是使用继承关系连接到Adaptee类，而是使用代理关系连接到Adaptee类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Target</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Target</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">target</span><span class="params">()</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Adaptee</span></div><div class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Adaptee</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">adaptee</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"adaptee..."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Adapter</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Adapter</span> <span class="keyword">implements</span> <span class="title">Target</span> </span>&#123;</div><div class="line">  </div><div class="line">  <span class="keyword">private</span> Adaptee adaptee;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAdaptee</span><span class="params">(Adaptee adaptee)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.adaptee = adaptee;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">target</span><span class="params">()</span> </span>&#123;</div><div class="line">    convertFromAdapteeToTarget();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">convertFromAdapteeToTarget</span><span class="params">()</span> </span>&#123;</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>建议尽量使用对象适配器的实现方式，多用合成/聚合，少用继承。</p>
<p>下面看看Android中的ListView是如何使用适配器模式的，首先看一下使用ListView的代码：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">ListView mListView = (ListView) findViewById(R.id.listview);</div><div class="line">mListView.setAdapter(<span class="keyword">new</span> MyAdappter(context, datas));</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> LayoutInflater inflater;</div><div class="line">  List&lt;String&gt; datas;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MyAdapter</span><span class="params">(Context context, List&lt;String&gt; datas)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.inflater = LayoutInflater.from(context);</div><div class="line">    <span class="keyword">this</span>.datas = datas;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> datas.size();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> datas.get(position);</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> position;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</div><div class="line">    ViewHolder holder = <span class="keyword">null</span>;</div><div class="line">    <span class="comment">// Item View的复用</span></div><div class="line">    <span class="keyword">if</span> (convertView == <span class="keyword">null</span>) &#123;</div><div class="line">      holder = <span class="keyword">new</span> ViewHolder();  </div><div class="line">      convertView = mInflater.inflate(R.layout.my_listview_item, <span class="keyword">null</span>);</div><div class="line">      <span class="comment">// 获取title</span></div><div class="line">      holder.title = (TextView)convertView.findViewById(R.id.title);</div><div class="line">      convertView.setTag(holder);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      holder = (ViewHolder)convertView.getTag();</div><div class="line">    &#125;</div><div class="line">    holder.title.setText(mDatas.get(position));</div><div class="line">    <span class="keyword">return</span> convertView;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  那么为什么这里需要使用Adapter模式呢？我们知道，ListView需要能够显示各种各样的视图，每个人需要的显示效果不相同，显示的数据类型、数量也各不相同，那么如何隔离这种变化就很重要！</p>
<p>  Android中的做法是增加一个Adapter层来应对变化，将ListView需要的接口抽象到Adapter对象中，这样只要用户实现了Adapter接口，ListView就可以按照用户设定的显示效果、数量、数据来显示特定的item view。</p>
<p>  通过代理数据集来告知ListView数据的个数( getCount函数 )以及每个数据的类型( getItem函数 )，最重要的是要解决Item View的输出。Item View千变万化，但终究它都是View类型，Adapter统一将Item View输出View ( getView函数 )，这样就很好的应对了Item View的可变性。</p>
<p>  那么ListView是如何通过Adapter模式 ( 不止Adapter模式 )来运作的呢 ？我们一起来看一看。 ListView继承自AbsListView，Adapter定义在AbsListView中，我们看一看这个类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbsListView</span> <span class="keyword">extends</span> <span class="title">AdapterView</span>&lt;<span class="title">ListAdapter</span>&gt; <span class="keyword">implements</span> <span class="title">TextWatcher</span>,</span></div><div class="line">        <span class="title">ViewTreeObserver</span>.<span class="title">OnGlobalLayoutListener</span>, <span class="title">Filter</span>.<span class="title">FilterListener</span>,</div><div class="line">        <span class="title">ViewTreeObserver</span>.<span class="title">OnTouchModeChangeListener</span>,</div><div class="line">        <span class="title">RemoteViewsAdapter</span>.<span class="title">RemoteAdapterConnectionCallback</span> &#123;</div><div class="line"></div><div class="line">    ListAdapter mAdapter ;</div><div class="line"></div><div class="line">    <span class="comment">// 关联到Window时调用的函数</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onAttachedToWindow</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onAttachedToWindow();</div><div class="line">        <span class="comment">// 代码省略</span></div><div class="line">        <span class="comment">// 给适配器注册一个观察者,该模式下一篇介绍。</span></div><div class="line">        <span class="keyword">if</span> (mAdapter != <span class="keyword">null</span> &amp;&amp; mDataSetObserver == <span class="keyword">null</span>) &#123;</div><div class="line">            mDataSetObserver = <span class="keyword">new</span> AdapterDataSetObserver();</div><div class="line">            mAdapter.registerDataSetObserver(mDataSetObserver);</div><div class="line"></div><div class="line">            <span class="comment">// Data may have changed while we were detached. Refresh.</span></div><div class="line">            mDataChanged = <span class="keyword">true</span>;</div><div class="line">            mOldItemCount = mItemCount</div><div class="line">            <span class="comment">// 获取Item的数量,调用的是mAdapter的getCount方法</span></div><div class="line">            mItemCount = mAdapter.getCount();</div><div class="line">        &#125;</div><div class="line">        mIsAttached = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">  	<span class="comment">/**</span></div><div class="line">     * 子类需要覆写layoutChildren()函数来布局child view,也就是Item View</div><div class="line">     */</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onLayout</span><span class="params">(<span class="keyword">boolean</span> changed, <span class="keyword">int</span> l, <span class="keyword">int</span> t, <span class="keyword">int</span> r, <span class="keyword">int</span> b)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onLayout(changed, l, t, r, b);</div><div class="line">        mInLayout = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">if</span> (changed) &#123;</div><div class="line">            <span class="keyword">int</span> childCount = getChildCount();</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; childCount; i++) &#123;</div><div class="line">                getChildAt(i).forceLayout();</div><div class="line">            &#125;</div><div class="line">            mRecycler.markChildrenDirty();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (mFastScroller != <span class="keyword">null</span> &amp;&amp; mItemCount != mOldItemCount) &#123;</div><div class="line">            mFastScroller.onItemCountChanged(mOldItemCount, mItemCount);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 布局Child View</span></div><div class="line">        layoutChildren();</div><div class="line">        mInLayout = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        mOverscrollMax = (b - t) / OVERSCROLL_LIMIT_DIVISOR;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 获取一个Item View</span></div><div class="line">    <span class="function">View <span class="title">obtainView</span><span class="params">(<span class="keyword">int</span> position, <span class="keyword">boolean</span>[] isScrap)</span> </span>&#123;</div><div class="line">        isScrap[<span class="number">0</span>] = <span class="keyword">false</span>;</div><div class="line">        View scrapView;</div><div class="line">        <span class="comment">// 从缓存的Item View中获取,ListView的复用机制就在这里</span></div><div class="line">        scrapView = mRecycler.getScrapView(position);</div><div class="line"></div><div class="line">        View child;</div><div class="line">        <span class="keyword">if</span> (scrapView != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="comment">// 代码省略</span></div><div class="line">            child = mAdapter.getView(position, scrapView, <span class="keyword">this</span>);</div><div class="line">            <span class="comment">// 代码省略</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            child = mAdapter.getView(position, <span class="keyword">null</span>, <span class="keyword">this</span>);</div><div class="line">            <span class="comment">// 代码省略</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> child;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  AbsListView定义了集合视图的框架，比如Adapter模式的应用、复用Item View的逻辑、布局Item View的逻辑等。子类只需要覆写特定的方法即可实现集合视图的功能，例如ListView。</p>
<p>  ListView中相关方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">layoutChildren</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// 代码省略</span></div><div class="line"></div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">super</span>.layoutChildren();</div><div class="line">    invalidate();</div><div class="line">    <span class="comment">// 代码省略</span></div><div class="line">    <span class="comment">// 根据布局模式来布局Item View</span></div><div class="line">    <span class="keyword">switch</span> (mLayoutMode) &#123;</div><div class="line">      <span class="keyword">case</span> LAYOUT_SET_SELECTION:</div><div class="line">        <span class="keyword">if</span> (newSel != <span class="keyword">null</span>) &#123;</div><div class="line">          sel = fillFromSelection(newSel.getTop(), childrenTop, childrenBottom);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          sel = fillFromMiddle(childrenTop, childrenBottom);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> LAYOUT_SYNC:</div><div class="line">        sel = fillSpecific(mSyncPosition, mSpecificTop);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> LAYOUT_FORCE_BOTTOM:</div><div class="line">        sel = fillUp(mItemCount - <span class="number">1</span>, childrenBottom);</div><div class="line">        adjustViewsUpOrDown();</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> LAYOUT_FORCE_TOP:</div><div class="line">        mFirstPosition = <span class="number">0</span>;</div><div class="line">        sel = fillFromTop(childrenTop);</div><div class="line">        adjustViewsUpOrDown();</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> LAYOUT_SPECIFIC:</div><div class="line">        sel = fillSpecific(reconcileSelectedPosition(), mSpecificTop);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> LAYOUT_MOVE_SELECTION:</div><div class="line">        sel = moveSelection(oldSel, newSel, delta, childrenTop, childrenBottom);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">default</span>:</div><div class="line">        <span class="comment">// 代码省略</span></div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// 从上到下填充Item View  [ 只是其中一种填充方式 ]</span></div><div class="line">  <span class="function"><span class="keyword">private</span> View <span class="title">fillDown</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> nextTop)</span> </span>&#123;</div><div class="line">    View selectedView = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> end = (mBottom - mTop);</div><div class="line">    <span class="keyword">if</span> ((mGroupFlags &amp; CLIP_TO_PADDING_MASK) == CLIP_TO_PADDING_MASK) &#123;</div><div class="line">      end -= mListPadding.bottom;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (nextTop &lt; end &amp;&amp; pos &lt; mItemCount) &#123;</div><div class="line">      <span class="comment">// is this the selected item?</span></div><div class="line">      <span class="keyword">boolean</span> selected = pos == mSelectedPosition;</div><div class="line">      View child = makeAndAddView(pos, nextTop, <span class="keyword">true</span>, mListPadding.left, selected);</div><div class="line"></div><div class="line">      nextTop = child.getBottom() + mDividerHeight;</div><div class="line">      <span class="keyword">if</span> (selected) &#123;</div><div class="line">        selectedView = child;</div><div class="line">      &#125;</div><div class="line">      pos++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> selectedView;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// 添加Item View</span></div><div class="line">  <span class="function"><span class="keyword">private</span> View <span class="title">makeAndAddView</span><span class="params">(<span class="keyword">int</span> position, <span class="keyword">int</span> y, <span class="keyword">boolean</span> flow, <span class="keyword">int</span> childrenLeft,</span></span></div><div class="line">                              <span class="keyword">boolean</span> selected) &#123;</div><div class="line">    View child;</div><div class="line"></div><div class="line">    <span class="comment">// 代码省略 </span></div><div class="line">    <span class="comment">// Make a new view for this position, or convert an unused view if possible</span></div><div class="line">    child = obtainView(position, mIsScrap);</div><div class="line"></div><div class="line">    <span class="comment">// This needs to be positioned and measured</span></div><div class="line">    setupChild(child, position, y, flow, childrenLeft, selected, mIsScrap[<span class="number">0</span>]);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> child;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>  ListView覆写了AbsListView中的layoutChilden函数，在该函数中根据布局模式来布局Item View。Item View的个数、样式都通过Adapter对应的方法来获取，获取个数、Item View之后，将这些Item View布局到ListView对应的坐标上，再加上Item View的复用机制，整个ListView就基本运转起来了。</p>
<p>  当然这里的Adapter并不是经典的适配器模式，但是却是对象适配器模式的优秀示例，也很好的体现了面向对象的一些基本原则。这里的Target角色和Adapter角色融合在一起，Adapter中的方法就是目标方法；而Adaptee角色就是ListView的数据集与Item View，Adapter代理数据集，从而获取到数据集的个数、元素。</p>
<p>  通过增加Adapter一层来将Item View的操作抽象起来，ListView等集合视图通过Adapter对象获得Item的个数、数据元素、Item View等，从而达到适配各种数据、各种Item视图的效果。因为Item View和数据类型千变万化，<a href="http://lib.csdn.net/base/android的[架构](http://lib.csdn.net/base/architecture" target="_blank" rel="external">android</a>师们将这些变化的部分交给用户来处理，通过getCount、getItem、getView等几个方法抽象出来，也就是将Item View的构造过程交给用户来处理，灵活地运用了适配器模式，达到了无限适配、拥抱变化的目的。</p>
<p>  本章节转载自文章<a href="http://blog.csdn.net/bboyfeiyu/article/details/43950185" target="_blank" rel="external">Android源码之ListView的适配器模式</a>。</p>
<ul>
<li><p>FrameLayout的特点就是FrameLayout中的多个布局会重叠显示，看下面这段代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span>&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/tb_joke"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></div><div class="line">        <span class="attr">android:background</span>=<span class="string">"?attr/colorPrimary"</span></div><div class="line">        <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:titleTextColor</span>=<span class="string">"#fff"</span>&gt;</div><div class="line">        <span class="tag">&lt;<span class="name">ImageView</span></span></div><div class="line">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">            <span class="attr">android:src</span>=<span class="string">"@drawable/ic_joke_title"</span>/&gt;</div><div class="line">    <span class="tag">&lt;/<span class="name">android.support.v7.widget.Toolbar</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</div><div class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></div><div class="line">            <span class="attr">android:id</span>=<span class="string">"@+id/ll_loading"</span></div><div class="line">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">            <span class="attr">android:gravity</span>=<span class="string">"center"</span></div><div class="line">            <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></div><div class="line">            <span class="attr">android:visibility</span>=<span class="string">"visible"</span>&gt;</div><div class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">                <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">                <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">                <span class="attr">android:text</span>=<span class="string">"正在加载中"</span>/&gt;</div><div class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></div><div class="line">            <span class="attr">android:visibility</span>=<span class="string">"gone"</span></div><div class="line">            <span class="attr">android:id</span>=<span class="string">"@+id/ll_error"</span></div><div class="line">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">            <span class="attr">android:gravity</span>=<span class="string">"center"</span></div><div class="line">            <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</div><div class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">                <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">                <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">                <span class="attr">android:text</span>=<span class="string">"加载失败"</span>/&gt;</div><div class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">                <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">                <span class="attr">android:clickable</span>=<span class="string">"true"</span></div><div class="line">                <span class="attr">android:id</span>=<span class="string">"@+id/tv_joke_load_again"</span></div><div class="line">                <span class="attr">android:background</span>=<span class="string">"#d7d6d6"</span></div><div class="line">                <span class="attr">android:padding</span>=<span class="string">"10dp"</span></div><div class="line">                <span class="attr">android:text</span>=<span class="string">"重新加载"</span>/&gt;</div><div class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">android.support.v4.widget.SwipeRefreshLayout</span></span></div><div class="line">            <span class="attr">android:id</span>=<span class="string">"@+id/srl_joke"</span></div><div class="line">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</div><div class="line">            <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></div><div class="line">                <span class="attr">android:id</span>=<span class="string">"@+id/rv_joke"</span></div><div class="line">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">                <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</div><div class="line">            <span class="tag">&lt;/<span class="name">android.support.v7.widget.RecyclerView</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">android.support.v4.widget.SwipeRefreshLayout</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在FrameLayout中包含了3个子布局，即两个LinearLayout和一个SwipeRefreshLayout，三者会重叠显示，那么在代码中通过控制各个不同的布局在不同情况下的显示和消失就可以显示几种不同的布局。</p>
</li>
<li><p><code>android:imeOptions</code>属性</p>
<p>默认情况下软键盘右下角按钮为“下一个”，点击会进入到下一个输入框，保持软键盘，设置<code>android:imeOptions=actionDone</code>，软键盘下方变成完成，点击后光标保持在原来的输入框中，并且软键盘关闭，设置<code>android:imeOptions=actionSend</code>软键盘下方变成“发送”，点击后光标移动到下一个，那么设置的imeOptions如何使用呢？一般情况下可以这样使用：让EditText实现<code>OnEditorActionListener</code>，在<code>onEditActin</code>方法中actionId就对应我们设置的imeOptions，系统默认的actionId有<code>EditorInfo.IME_NULL</code>、<code>EditorInfo.IME_ACTION_SEND</code>、<code>EditorInfo.IME_ACTION_DONE</code>，这样就可以根据不同的EditText实现不同的软键盘右下角功能键：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 设置软键盘的操作</span></div><div class="line">etInput.setImeOptions(EditorInfo.IME_ACTION_SEARCH);</div><div class="line">...</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onEditorAction</span><span class="params">(TextView v, <span class="keyword">int</span> actionId, KeyEvent event)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (actionId == EditorInfo.IME_ACTION_SEND) &#123;</div><div class="line">      ...</div><div class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      ...</div><div class="line">    &#125;</div><div class="line">    closeKeyBoard();</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p><code>android:clipToPadding</code>的作用</p>
<p>常常用于paddingTop的情况，并且默认情况下其值为true，当内部有个属性设置了paddingTop但是滑动的时候就忽视paddingTop则可以设置<code>android:clipToPadding=&quot;false&quot;</code>。</p>
<p>大家可以参考 <a href="http://blog.csdn.net/hpu_zyh/article/details/44520949" target="_blank" rel="external">Padding与绘制区域–android:clipToPadding和android:clipChildren</a>这篇文章，看了图就懂了！</p>
<p>另外再推荐一篇文章<a href="https://livesun.github.io/2017/06/14/clippaading/" target="_blank" rel="external">android:clipToPadding属性应用</a>，这篇文章讲的蛮好的，其效果图如下：</p>
<ul>
<li><p><code>android:clipToPadding=&quot;true&quot;</code></p>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/clippadding1.gif" alt=""></p>
</li>
<li><p><code>android:clipToPadding=&quot;false&quot;</code></p>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/clippadding2.gif" alt=""></p>
</li>
</ul>
</li>
<li><p>Java中indexOf方法</p>
<p>indexOf()方法用于在字符串中查找子串，该方法返回一个整数，指出String对象内子字符串的开始位置，如果没有找到该子串，则返回-1。</p>
<p>indexof()方法的函数原型如下：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(String str)</span></span>; <span class="comment">// 返回第一次出现的指定子字符串在字符串中的索引</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(String str, <span class="keyword">int</span> startIndex)</span></span>; <span class="comment">// 从指定的索引开始，返回第一次出现的指定字符串在此字符串中的索引</span></div></pre></td></tr></table></figure>
<ul>
<li><p>Android在实现界面刷新时有两种方法<code>invalidate</code>和<code>postInvalidate</code>，两者的区别在于<code>invalidate</code>方法不能直接在线程中调用，必须在UI线程中调用，而<code>postInvalidate</code>可以在工作线程中调用。</p>
</li>
<li><p>设置画笔属性</p>
</li>
<li><p><code>setAntiAlias(boolean aa)</code></p>
<p>打开抗锯齿，抗锯齿是依赖于算法的，算法决定抗锯齿的效率，我们在绘制棱角分明的图像时，比如一个矩形、一张位图，我们不需要打开抗锯齿</p>
</li>
<li><p><code>setColorFilter(ColorFilter filter)</code></p>
<p>这个方法需要传入一个<code>ColorFilter</code>参数同样也会返回一个<code>ColorFilter</code>实例，其实<code>ColorFilter</code>类是一个父类，其有3个子类，分别为<code>ColorMatrixColorFilter</code>、<code>LightingColorFilter</code>和<code>PorterDuffColorFilter</code>。</p>
<ul>
<li><p><code>ColorMatrixColorFilter</code></p>
<p>色彩矩阵颜色过滤器，在Android中图片是以RGBA像素点的形式加载到内存中的，修改这些像素信息需要一个叫做<code>ColorMatrix</code>类的支持，其定义了一个<code>4*5</code>的<code>float[]</code>类型的矩阵：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ColorMatrix colorMatrix = <span class="keyword">new</span> ColorMatrix(<span class="keyword">new</span> <span class="keyword">float</span>[]&#123;  </div><div class="line">        <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,  </div><div class="line">        <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,  </div><div class="line">        <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,  </div><div class="line">        <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,  </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>第一行表示的R（红色）的向量，第二行表示的G（绿色）的向量，第三行表示的B（蓝色）的向量，最后一行表示A（透明度）的向量。这个矩阵不同的位置表示的RGBA值，其范围在0.0F至2.0F之间，1为保持原图的RGB值。每一行的第五列数字表示偏移值，何为偏移值？顾名思义当我们想让颜色更倾向于红色的时候就增大R向量中的偏移值，想让颜色更倾向于蓝色的时候就增大B向量中的偏移值。</p>
<p>通过修改<code>ColorMatrix</code>，我们可以修改颜色，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 生成色彩矩阵  </span></div><div class="line">ColorMatrix colorMatrix = <span class="keyword">new</span> ColorMatrix(<span class="keyword">new</span> <span class="keyword">float</span>[]&#123;  </div><div class="line">        <span class="number">0.5F</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,  </div><div class="line">        <span class="number">0</span>, <span class="number">0.5F</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,  </div><div class="line">        <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5F</span>, <span class="number">0</span>, <span class="number">0</span>,  </div><div class="line">        <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,  </div><div class="line">&#125;);  </div><div class="line">mPaint.setColorFilter(<span class="keyword">new</span> ColorMatrixColorFilter(colorMatrix));</div></pre></td></tr></table></figure>
<p>这其中的原理是这样的：</p>
<p><img src="http://img.blog.csdn.net/20141120171342412?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYWlnZXN0dWRpbw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
</li>
<li><p><code>LightingColorFilter</code></p>
<p>光照颜色过滤，这个方法只有一个构造方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LightingColorFilter(int mul, int add);</div></pre></td></tr></table></figure>
<p>其中<code>mul</code>全称是colorMultiply即色彩倍增，而add全称是colorAdd即色彩增加，这两个值都是16进制的0xAARRGGBB。</p>
</li>
<li><p><code>PorterDuffColorFilter</code></p>
<p><code>PorterDuffColorFilter</code>只有一个构造方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PorterDuffColorFilter(<span class="keyword">int</span> color, PorterDuff.Mode mode);</div></pre></td></tr></table></figure>
<p>这个构造方法也接受两个值，一个是16进制表示的颜色值这个很好理解，而另一个是<code>PorterDuff</code>内部类Mode中的一个常量值，这个值表示混合模式。那么什么是混合模式呢？混合混合必定是有两种东西混才行，第一种就是我们设置的color值而第二种当然就是我们画布上的元素了！，比如这里我们把Color的值设为红色，而模式设为<code>PorterDuff.Mode.DARKEN</code>变暗：</p>
</li>
</ul>
</li>
<li><p><code>ViewConfiguration.getScaledTouchSlop()</code></p>
<p><code>getScaledTouchSlop</code>是一个距离，表示滑动的时候，手的移动要大于这个距离才开始移动控件。如果小于这个距离就不触发移动控件，如viewpager就是用这个距离来判断用户是否翻页</p>
</li>
<li><p>Android中全局Application的onCreate()方法多次调用问题</p>
<p>通常，一个应用的所有组件都运行在系统为这个应用所创建的默认进程中，这个默认进程是用这个应用的包名来命名的，如果声明文件中的组件或应用没有指定这个属性则默认应用和其组件将相应运行在以其包名命名的进程中。</p>
<p>一般来说，Application的onCreate()方法只会执行一次，如果应用中采用多进程方式，onCreate()方法会执行多次，根据不同的进程名字进行不同的初始化。</p>
<p>一般情况下一个服务没有自己独立的进程，它一般是作为一个线程运行于它所在的应用的进程中，但是也有例外，Android声明文件中的<code>android:process</code>属性却可以为任意组件包括应用指定进程，即通过在声明文件中设置<code>android:process</code>属性，我们可以让组件（例如Activity、Service）和应用（Application）创建并运行于我们指定的进程中，冒号（”:”）这个前缀将把这个名字附加到你的包所运行的标准进程名字的后面作为新的进程名称：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">service</span> <span class="attr">android:name</span>=<span class="string">"com.baidu.location.f"</span></span></div><div class="line">         <span class="attr">android:enabled</span>=<span class="string">"true"</span></div><div class="line">         <span class="attr">android:process</span>=<span class="string">":baiduMap"</span>&gt;<span class="tag">&lt;/<span class="name">service</span>&gt;</span></div></pre></td></tr></table></figure>
<p>那么在DDMS中就可以看到这个进程：<code>com.example.hello:baiduMap</code>。</p>
<p>解决方法是在自定义的Application的onCreate方法中控制不同进程的初始化：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">String processName = getProcessName(<span class="keyword">this</span>, android.os.Process.myPid());  </div><div class="line"><span class="keyword">if</span> (processName != <span class="keyword">null</span>) &#123;  </div><div class="line">    <span class="keyword">boolean</span> defaultProcess = processName.equals(Constants.REAL_PACKAGE_NAME);  </div><div class="line">    <span class="comment">// 默认的主进程启动时初始化应用  </span></div><div class="line">    <span class="keyword">if</span> (defaultProcess) &#123;  </div><div class="line">      	initAppForMainProcess();  </div><div class="line">    &#125;   </div><div class="line">    <span class="comment">// 其他进程启动时初始化对应内容  </span></div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (processName.contains(<span class="string">":webbrowser"</span>)) &#123;  </div><div class="line"></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (processName.contains(<span class="string">":wallet"</span>)) &#123;  </div><div class="line"></div><div class="line">    &#125;  </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getProcessName</span><span class="params">(Context cxt, <span class="keyword">int</span> pid)</span> </span>&#123;  </div><div class="line">    ActivityManager am = (ActivityManager) cxt.getSystemService(Context.ACTIVITY_SERVICE);  </div><div class="line">    List&lt;RunningAppP.rocessInfo&gt; runningApps = am.getRunningAppProcesses();  </div><div class="line">    <span class="keyword">if</span> (runningApps == <span class="keyword">null</span>) &#123;  </div><div class="line">      	<span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">for</span> (RunningAppProcessInfo procInfo : runningApps) &#123;  </div><div class="line">        <span class="keyword">if</span> (procInfo.pid == pid) &#123;  </div><div class="line">         	<span class="keyword">return</span> procInfo.processName;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>本小节转载自文章<a href="http://blog.csdn.net/xiaoxuanfeng1986/article/details/49490909" target="_blank" rel="external">Android中全局Application的onCreate多次调用问题</a>。</p>
</li>
<li><p>Java静态方法可以被重写吗？</p>
<p>非静态方法属于类的实例，是可以被子类重写从而达到多态的效果，静态方法属于类，是不能被重写，故而不能实现多态。</p>
</li>
<li><p>compileSdkVersion</p>
<p>表示编译版本，就是运行我们这个项目的SDK版本号，也就是API Level，例如API-19、API-20等</p>
</li>
<li><p>buildToolVersion</p>
<p>表示构建工具的版本，其中包含了打包工具aapt、dx等等，这个工具的目录位于..your_sdk_path/build_tools/xx.xx.xx</p>
</li>
<li><p>minSdkVersion</p>
<p>指定应用程序所需的最小API Level，如果不指明的话默认为1，也就是说该应用兼容所有的android版本，我们应该总是声明这个属性。</p>
<p>如果系统的API Level低于minSdkVersion，那么android系统会阻止用户安装这个应用。</p>
<p>如果指明了这个属性，并且在项目中使用了高于这个API Levle的API，那么在编译时就会报错。</p>
<p>因此，minSdkVersion不仅在安装程序时起作用，也会在项目构建时起作用。</p>
</li>
<li><p>targetSdkVersion</p>
<p>targetSdkVersion是Android系统提供向前兼容的主要手段，随着Android系统的升级，某个系统的API或者模块的行为可能会发生变化，但是为了保证老APK的行为还是和以前兼容，只要targetSdkVersion不变，即使这个APK安装在新Android系统上，其行为还是保持老的系统上的行为，这样就保证了系统对老应用的向前兼容性。</p>
<p>在 Android 4.4 (API 19）以后，AlarmManager 的 set() 和 setRepeat() 这两个 API 的行为发生了变化。在 Android 4.4 以前，这两个 API 设置的都是精确的时间，系统能保证在 API 设置的时间点上唤醒 Alarm。因为省电原因 Android 4.4 系统实现了 AlarmManager 的对齐唤醒，这两个 API 设置唤醒的时间，系统都对待成不精确的时间，系统只能保证在你设置的时间点之后某个时间唤醒。</p>
<p>这时，虽然 API 没有任何变化，但是实际上 API 的行为却发生了变化，如果老的 APK 中使用了此 API，并且在应用中的行为非常依赖 AlarmManager 在精确的时间唤醒，例如闹钟应用。如果 Android 系统不能保证兼容，老的 APK 安装在新的系统上，就会出现问题。</p>
<p>Android 系统是怎么保证这种兼容性的呢？这时候 targetSdkVersion 就起作用了。APK 在调用系统 AlarmManager 的 set() 或者 setRepeat() 的时候，系统首先会查一下调用的 APK 的 targetSdkVersion 信息，如果小于 19，就还是按照老的行为，即精确设置唤醒时间，否者执行新的行为。</p>
<p>本小节转载自文章<a href="http://blog.csdn.net/zzf112/article/details/53127515" target="_blank" rel="external">Android targetSdkVersion 原理</a>。</p>
<p>​</p>
</li>
</ul>

                
<p class="pink-link-context">
    <a href="/2017/08/11/[Android] Android自定义View修炼之路(1)/" rel="next" title="[Android] Android自定义View修炼之路(1)">
    上一篇：[Android] Android自定义View修炼之路(1)
  </a>
</p>



<p class="pink-link-context">
    <a href="/2017/08/03/[Android] Build.VERSION_CODES类下面的版本信息/" rel="next" title="[Android] Build.VERSION_CODES类下面的版本信息">
    下一篇：[Android] Build.VERSION_CODES类下面的版本信息
  </a>
</p>


            </div>
			
        </div>
    </div>
</article>






</div>

        <div class="fixed-action-btn float-sitemap">
    <a class="btn-floating btn-large pink">
      <i class="fa fa-caret-square-o-up"></i>
    </a>
    <ul>
      <li><a class="btn-return-top btn-floating waves-effect green" title="回到顶部"><i class="fa fa-arrow-circle-o-up"></i></a></li>
      <li><a class="btn-floating waves-effect button-collapse yellow darken-1"  data-activates="main-menu" title="菜单"><i class="fa fa-navicon"></i></a></li>
    </ul>
  </div>

    </main>
    <footer class="page-footer indigo darken-1">
    
    <div class="footer-container container">
        <div class="row">
            
            <div class="social-group col m4 s12">
                <h5 class="white-text">社交</h5>
                
                    <a class="social-link" href="https://weibo.com/2520520192" target="_blank">
                        <i class="fa fa-2x fa-weibo"></i>
                    </a>
                
                    <a class="social-link" href="https://github.com/Glemontree" target="_blank">
                        <i class="fa fa-2x fa-github"></i>
                    </a>
                
                    <a class="social-link" href="/atom.xml" target="_blank">
                        <i class="fa fa-2x fa-rss"></i>
                    </a>
                
                
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
    <div class="site-visitors-container white-text">
        <span>
            <i class="fa fa-user"></i>
            <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
        </span>
        <span>&nbsp;|&nbsp;</span>
        <span>
            <i class="fa fa-eye"></i>
            <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
        </span>
    </div>


            </div>
            

            
            <div class="col m8 s12">
                <h5 class="white-text">友情链接</h5>
                
                    <a class="social-link" href="https://glemontree.github.io/" target="_blank">我的博客</a>
                
                    <a class="social-link" href="https://github.com/Glemontree" target="_blank">Github地址</a>
                
            </div>
            
        </div>
    </div>
    

    <div class="footer-copyright pink-link-context">
        <div class="container">
            © 2016 example.com, All rights reserved.
            <p class="right" style="margin-top: 0;">本博客由 <a href="https://hexo.io">Hexo</a> 强力驱动 | 主题 <a href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a></p>
        </div>
    </div>
</footer>


    <noscript>
    <div class="noscript">
        <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
    </div>
</noscript>
<div class="noscript">
    <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>

<script>
    (function($) {
        $(document).ready(function() {
            // 隐藏禁用javascript（针对微信内置浏览器）的提示
            $('.noscript').hide();

            // 图片缩放效果
            var $imgs = $('img').not('.slider-image').not('.avatar-image').not('.carousel-image').not('.card-cover-image').not('.qrcode');

            // 给图片加上点击放大效果（materialbox插件）
            $imgs.addClass('materialboxed').each(function(i, el) {
                $(this).attr('data-caption', $(this).attr('alt') || ' ');
            }).materialbox();

            // 优化表格的显示
            $('table').each(function() {
                var $table = $(this);
                // 除去多行代码的情况
                if ($table.find('pre').length == 0) {
                    $table.addClass('responsive-table striped bordered');
                }
            });

            // 首页幻灯片
            $('.slider').slider({indicators: true, full_width: true, interval: 8000});

            $(".button-collapse").sideNav();
            $(".category-menu").sideNav();

            // 针对gallery post
            $('.carousel').carousel({full_width: true});
            $('.carousel-control.prev').click(function() {
                $('.carousel').carousel('prev');
            });
            $('.carousel-control.next').click(function() {
                $('.carousel').carousel('next');
            });

            // 文章目录
            $('article').not('.simple-article').find('h1').add('h2').add('h3').add('h4').add('h5').add('h6').scrollSpy();

            // 目录随屏幕滚动（防止目录过长越过footer）
            var $toc = $('.toc');
            var scrollTargetTop = 0;
            $(window).scroll(function() {
                var $activeLink = $toc.find('a.active.section');
                if ($(window).scrollTop() < 100) {
                    scrollTargetTop = 0;
                } else {
                    if ($activeLink[0]) {
                        scrollTargetTop = $activeLink.offset().top - $toc.offset().top;
                    }
                }
                $toc.css('top', '-' + scrollTargetTop + 'px');
            });

            // 修正文章目录的left-border颜色
            var color = $('.table-of-contents-text').css('color');
            $('.table-of-contents-link').css('border-left-color', color);

            // 针对移动端做的优化：FAB按钮点击一下收回
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.fixed-action-btn').addClass('click-to-toggle');
            }
            // 回到顶部
            $('.btn-return-top').click(function() {
                $('body, html').animate({
                    scrollTop: 0
                }, 500);
            });

            // 重置读书页面的Tab标签页的颜色
            $('li.tab a').hover(function() {
                $(this).toggleClass('text-lighten-4');
            });
            $('.indicator').addClass('pink lighten-2');

            
            // 添加new标签
            $('.menu-reading, .menu-about').append('<span class="new badge pink"></span>');
            

            // 搜索功能
            $('.modal-trigger').leanModal({
                // 打开搜索框时自动聚焦
                ready: function() {
                    if ($('#search').is(":visible")) {
                        $('#search-input').focus();
                    }
                }
            });
            var searchXml = "search.xml";
            if (searchXml.length == 0) {
             	searchXml = "search.xml";
            }
            var searchPath = "/" + searchXml;
            initSearch(searchPath, 'search-input', 'search-result');
        });

        // 初始化搜索与匹配函数
        var initSearch = function(path, search_id, content_id) {
            'use strict';
            $.ajax({
                url: path,
                dataType: "xml",
                success: function(xmlResponse) {
                    // get the contents from search data
                    var datas = $("entry", xmlResponse).map(function() {
                        return {
                            title: $("title", this).text(),
                            content: $("content", this).text(),
                            url: $("url", this).text()
                        };
                    }).get();
                    var $input = document.getElementById(search_id);
                    var $resultContent = document.getElementById(content_id);
                    $input.addEventListener('input', function() {
                        var str = '<ul class=\"search-result-list\">';
                        var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                        $resultContent.innerHTML = "";
                        if (this.value.trim().length <= 0) {
                            return;
                        }
                        // perform local searching
                        datas.forEach(function(data) {
                            var isMatch = true;
                            var content_index = [];
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty titles and contents
                            if (data_title != '' && data_content != '') {
                                keywords.forEach(function(keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);
                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            }
                            // show search results
                            if (isMatch) {
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    data_title = data_title.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                });

                                str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 100 characters
                                    var start = first_occur - 20;
                                    var end = first_occur + 80;
                                    if (start < 0) {
                                        start = 0;
                                    }
                                    if (start == 0) {
                                        end = 100;
                                    }
                                    if (end > content.length) {
                                        end = content.length;
                                    }
                                    var match_content = content.substring(start, end);
                                    // highlight all keywords
                                    keywords.forEach(function(keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                    });

                                    str += "<p class=\"search-result\">..." + match_content + "...</p>"
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        $resultContent.innerHTML = str;
                    });
                }
            });
        }
    })(jQuery);
</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



</body>
</html>
